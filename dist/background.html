<!doctype html>
<script>
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {

  var window_options = 'location=no,directories=no,menubar=no,status=no,titlebar=no,toolbar=no,width=500,height=500';

  /* Open a new window with a unique name */
  window.open('player.html', 'Popout_for_YouTube' + request.title, window_options);

  /* Find the new tab in the new window */
  chrome.windows.getLastFocused(function(win) {
    chrome.tabs.getAllInWindow(win.id, function(tabs) {

      /* Tell the tab about the video so it can embed and play it */
      chrome.tabs.sendRequest(tabs[0].id, {
        id: request.id,
        title: request.title,
        time: request.time,
        width: request.width,
        height: request.height
      });

    });

  });
  sendResponse({});
});
</script>

